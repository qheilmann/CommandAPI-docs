<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Requirements - CommandAPI Documentation v9.6.0</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fontawesome/css/fontawesome.css">
        <link rel="stylesheet" href="fontawesome/css/brands.css">
        <link rel="stylesheet" href="fontawesome/css/solid.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="style.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="intro.html">Introduction</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Server Owner Usage</li><li class="chapter-item expanded "><a href="installation.html">Installation for server owners</a></li><li class="chapter-item expanded "><a href="config.html">Configuration for server owners</a></li><li class="chapter-item expanded "><a href="conversionforowners.html">Command conversion</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="conversionforownerssingle.html">Single command conversion</a></li><li class="chapter-item expanded "><a href="conversionforownerssingleargs.html">Single command conversion (with arguments)</a></li><li class="chapter-item expanded "><a href="conversionentityselectors.html">Entity selectors</a></li></ol></li><li class="chapter-item expanded "><a href="skippingproxysenders.html">Skipping proxy senders</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">CommandAPI Setup</li><li class="chapter-item expanded "><a href="setup_dev.html">Setting up your development environment</a></li><li class="chapter-item expanded "><a href="setup_shading.html">Shading the CommandAPI in your plugins</a></li><li class="chapter-item expanded "><a href="setup_annotations.html">Using the annotation system</a></li><li class="chapter-item expanded affix "><li class="part-title">Creating Commands</li><li class="chapter-item expanded "><a href="commandregistration.html">Command registration</a></li><li class="chapter-item expanded "><a href="commandunregistration.html">Command unregistration</a></li><li class="chapter-item expanded "><a href="commandexecutors.html">Command executors</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="normalexecutors.html">Normal command executors</a></li><li class="chapter-item expanded "><a href="proxysender.html">Proxied commandsenders</a></li><li class="chapter-item expanded "><a href="native.html">Native commandsenders</a></li><li class="chapter-item expanded "><a href="resultingcommandexecutors.html">Resulting command executors</a></li><li class="chapter-item expanded "><a href="commandfailures.html">Handling command failures</a></li></ol></li><li class="chapter-item expanded "><a href="arguments.html">Command arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="commandarguments.html">CommandArguments</a></li><li class="chapter-item expanded "><a href="optional_arguments.html">Optional arguments</a></li><li class="chapter-item expanded "><a href="listed.html">Listed arguments</a></li><li class="chapter-item expanded "><a href="argumentsuggestions.html">Argument suggestions</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="suggestionsinfo.html">The SuggestionsInfo record</a></li><li class="chapter-item "><a href="stringargumentsuggestions.html">String argument suggestions</a></li><li class="chapter-item "><a href="safeargumentsuggestions.html">Safely typed argument suggestions</a></li><li class="chapter-item "><a href="tooltips.html">Argument suggestions with tooltips</a></li><li class="chapter-item "><a href="asyncsuggestions.html">Asynchronous suggestions</a></li></ol></li><li class="chapter-item expanded "><a href="argumenttypes.html">Argument types</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="argument_primitives.html">Primitive arguments</a></li><li class="chapter-item "><a href="argument_range.html">Ranged arguments</a></li><li class="chapter-item "><a href="argument_strings.html">String arguments</a></li><li class="chapter-item "><a href="category_positional_arguments.html">Positional arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="argument_locations.html">Location arguments</a></li><li class="chapter-item "><a href="argument_rotation.html">Rotation arguments</a></li><li class="chapter-item "><a href="argument_axis.html">AxisArguments</a></li></ol></li><li class="chapter-item "><a href="argument_chats.html">Chat arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="argument_chat_spigot.html">Spigot chat arguments</a></li><li class="chapter-item "><a href="argument_chat_adventure.html">Adventure chat arguments</a></li><li class="chapter-item "><a href="chatpreview.html">Chat preview</a></li></ol></li><li class="chapter-item "><a href="argument_entities.html">Entity & player arguments</a></li><li class="chapter-item "><a href="category_scoreboard_arguments.html">Scoreboard arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="argument_scoreboards.html">Scoreboard arguments</a></li><li class="chapter-item "><a href="argument_objectives.html">Objective arguments</a></li><li class="chapter-item "><a href="argument_team.html">Team arguments</a></li></ol></li><li class="chapter-item "><a href="category_miscellaneous_arguments.html">Miscellaneous arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="argument_angle.html">Angle arguments</a></li><li class="chapter-item "><a href="advancementargument.html">Advancement arguments</a></li><li class="chapter-item "><a href="argument_biome.html">Biome arguments</a></li><li class="chapter-item "><a href="argument_blockstate.html">BlockState arguments</a></li><li class="chapter-item "><a href="argument_enchantment.html">Enchantment arguments</a></li><li class="chapter-item "><a href="argument_itemstack.html">Itemstack arguments</a></li><li class="chapter-item "><a href="argument_loottable.html">LootTable argument</a></li><li class="chapter-item "><a href="argument_mathoperation.html">MathOperation arguments</a></li><li class="chapter-item "><a href="argument_namespacedkey.html">NamespacedKey arguments</a></li><li class="chapter-item "><a href="argument_particles.html">Particle arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="argument_particle_old.html">Particle data (before 1.20.5)</a></li><li class="chapter-item "><a href="argument_particle_new.html">Particle data (1.20.5+)</a></li></ol></li><li class="chapter-item "><a href="argument_potion.html">Potion effect arguments</a></li><li class="chapter-item "><a href="argument_recipe.html">Recipe arguments</a></li><li class="chapter-item "><a href="argument_sound.html">Sound arguments</a></li><li class="chapter-item "><a href="argument_time.html">Time arguments</a></li><li class="chapter-item "><a href="argument_uuid.html">UUID arguments</a></li><li class="chapter-item "><a href="argument_world.html">World arguments</a></li></ol></li><li class="chapter-item "><a href="predicateargs.html">Predicate arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="argument_blockpredicate.html">Block predicate arguments</a></li><li class="chapter-item "><a href="argument_itemstackpredicate.html">ItemStack predicate arguments</a></li></ol></li><li class="chapter-item "><a href="argument_nbt.html">NBT arguments</a></li><li class="chapter-item "><a href="category_literal_arguments.html">Literal arguments</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="argument_literal.html">Literal arguments</a></li><li class="chapter-item "><a href="argument_multiliteral.html">Multi literal arguments</a></li></ol></li><li class="chapter-item "><a href="argument_list.html">List arguments</a></li><li class="chapter-item "><a href="argument_map.html">Map arguments</a></li><li class="chapter-item "><a href="argument_command.html">Command arguments</a></li><li class="chapter-item "><a href="argument_custom.html">Custom arguments</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="functions.html">Functions & Tags</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="functionsetup.html">Setting up functions & tags</a></li><li class="chapter-item expanded "><a href="simplefunctionwrapper.html">The SimpleFunctionWrapper class</a></li><li class="chapter-item expanded "><a href="functionwrapper.html">The FunctionWrapper class</a></li><li class="chapter-item expanded "><a href="argument_function.html">Function arguments</a></li></ol></li><li class="chapter-item expanded "><a href="permissions.html">Permissions</a></li><li class="chapter-item expanded "><a href="requirements.html" class="active">Requirements</a></li><li class="chapter-item expanded "><a href="aliases.html">Aliases</a></li><li class="chapter-item expanded "><a href="help.html">Help</a></li><li class="chapter-item expanded "><a href="subcommands.html">Subcommands</a></li><li class="chapter-item expanded "><a href="commandtrees.html">Command trees</a></li><li class="chapter-item expanded affix "><li class="part-title">Annotation-based Commands</li><li class="chapter-item expanded "><a href="annotationsintro.html">Annotation-based commands</a></li><li class="chapter-item expanded "><a href="annotations.html">Annotations</a></li><li class="chapter-item expanded "><a href="registeringannotations.html">Registering annotation-based commands</a></li><li class="chapter-item expanded affix "><li class="part-title">Kotlin-based Commands</li><li class="chapter-item expanded "><a href="kotlinintro.html">Kotlin-based commands</a></li><li class="chapter-item expanded "><a href="kotlindsl.html">Using the DSL</a></li><li class="chapter-item expanded "><a href="delegated_properties.html">Delegated properties</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Velocity</li><li class="chapter-item expanded "><a href="velocity_intro.html">Velocity</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">CommandAPI Utilities</li><li class="chapter-item expanded "><a href="conversion.html">Command conversion</a></li><li class="chapter-item expanded "><a href="reloading.html">Plugin reloading</a></li><li class="chapter-item expanded affix "><li class="part-title">Internal CommandAPI</li><li class="chapter-item expanded "><a href="internal.html">Internal CommandAPI</a></li><li class="chapter-item expanded "><a href="brigadier.html">Brigadier + CommandAPI</a></li><li class="chapter-item expanded "><a href="brigadiersuggestions.html">Brigadier Suggestions</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Java Tips</li><li class="chapter-item expanded "><a href="predicatetips.html">Predicate tips</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">CommandAPI Contribution</li><li class="chapter-item expanded "><a href="contributionintro.html">Introduction</a></li><li class="chapter-item expanded "><a href="projectstructure.html">Project Structure</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="upgrading.html">Upgrading guide</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="upgrading_old.html">Upgrading guide (pre-9.0.0)</a></li></ol></li><li class="chapter-item expanded "><a href="faq.html">FAQ</a></li><li class="chapter-item expanded affix "><a href="incompatibleversions.html">Incompatible version information</a></li><li class="chapter-item expanded affix "><a href="troubleshooting.html">Troubleshooting</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="afterword.html">Afterword</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fas fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fas fa-palette"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="skepter">Skepter Likes Purple</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CommandAPI Documentation v9.6.0</h1>

                    <div class="right-buttons">
                        <a href="https://www.jorel.dev/CommandAPI/" title="Back to main CommandAPI page" aria-label="Back to main CommandAPI page">
                            <i id="home-button" class="fas fa-home"></i>
                        </a>
                        <a href="https://ko-fi.com/jorelali" title="Donate (ko-fi)" aria-label="Donate (ko-fi)">
                            <i id="donate-button" class="fas fa-donate"></i>
                        </a>
                        <a href="https://discord.com/invite/G4SzSxZ" title="Discord" aria-label="Discord">
                            <i id="discord-button" class="fab fa-discord"></i>
                        </a>
                        <a href="https://github.com/JorelAli/CommandAPI" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fab fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Page table of contents -->
                        <div class="sidetoc"><nav class="pagetoc"></nav></div>
                        
                        <h1 id="requirements"><a class="header" href="#requirements">Requirements</a></h1>
<p>Requirements is a feature that allows you to put a constraint on commands and arguments. Similar to permissions, a requirement is something that must be fulfilled in order to use a given command or argument.</p>
<p>This section is broken up into four parts:</p>
<ul>
<li>Adding requirements to commands</li>
<li>Adding requirements to arguments</li>
<li>Updating requirements</li>
<li>Multiple requirements</li>
</ul>
<p><strong>Please don't skip the section on updating requirements</strong> - the last section is necessary to get requirements to work as you'd want!</p>
<hr />
<h2 id="adding-requirements-to-commands"><a class="header" href="#adding-requirements-to-commands">Adding requirements to commands</a></h2>
<p>To add a requirement to a command, similar to adding permissions to commands, use the <code>withRequirement</code> method:</p>
<pre><code class="language-java">CommandAPICommand withRequirement(Predicate&lt;CommandSender&gt; sender);
</code></pre>
<p>The <code>withRequirement</code> method requires a predicate that determines if the sender is able to run the command - if the predicate is satisfied, then the command sender will be able to execute that command.</p>
<div class="example">
<h3 id="example---perks-based-on-a-players-level"><a class="header" href="#example---perks-based-on-a-players-level">Example - Perks based on a player's level</a></h3>
<p>Say we have a perks-based command system that depends on a player's level. For example, if a player has over 30 levels of experience, they would then be able to run a command that lets them repair the item in their hand in exchange for 30 levels. As such, we'll use the following command syntax:</p>
<pre><code class="language-mccmd">/repair
</code></pre>
<p>We want to put a requirement on this command that the player needs to have at least 30 levels of experience in order to run the command - if the player has less than 30 levels, the player should not be able to run the command. The easiest way to make the player not able to run the command is to literally tell the user that the command doesn't exist. That's what requirements do in the CommandAPI:</p>
<div class="multi-pre">
<pre><code class="language-java Java">new CommandAPICommand(&quot;repair&quot;)
    .withRequirement(sender -&gt; ((Player) sender).getLevel() &gt;= 30)
    .executesPlayer((player, args) -&gt; {
        
        // Repair the item back to full durability
        ItemStack is = player.getInventory().getItemInMainHand();
        ItemMeta itemMeta = is.getItemMeta();
        if (itemMeta instanceof Damageable damageable) {
            damageable.setDamage(0);
            is.setItemMeta(itemMeta);
        }
        
        // Subtract 30 levels
        player.setLevel(player.getLevel() - 30);
    })
    .register();
</code></pre>
<pre><code class="language-kotlin Kotlin">CommandAPICommand(&quot;repair&quot;)
    .withRequirement { (it as Player).level &gt;= 30 }
    .executesPlayer(PlayerCommandExecutor { player, _ -&gt;

        // Repair the item back to full durability
        val item = player.inventory.itemInMainHand
        val itemMeta = item.itemMeta
        if (itemMeta is Damageable) {
            itemMeta.setDamage(0)
            item.setItemMeta(itemMeta)
        }

        // Subtract 30 levels
        player.setLevel(player.level - 30)
    })
    .register()
</code></pre>
</div>
<p>It's important to note that in this example, we case the <code>sender</code> to a <code>player</code> for the requirement method. We know that the sender is definitely a player because we use <code>executesPlayer()</code>, which ensures that this is the case. Now that we've got this, <strong>we need to make sure we update the player's requirements <em>when their exp changes</em></strong>. This is covered in more detail in the section about updating requirements below.</p>
</div>
<hr />
<h2 id="adding-requirements-to-arguments"><a class="header" href="#adding-requirements-to-arguments">Adding requirements to arguments</a></h2>
<p>In a similar way that you can restrict certain arguments by adding permissions to them, you can restrict them by using arbitrary predicates by using the <code>withRequirement</code> method on the arguments themselves.</p>
<div class="example">
<h3 id="example---a-party-creation-and-teleportation-system"><a class="header" href="#example---a-party-creation-and-teleportation-system">Example - A party creation and teleportation system</a></h3>
<p>Let's say that we're working on a plugin that has a system to form groups of players called &quot;parties&quot;. If you are not already in a party, you can create one of your own and if you are in a party, you can teleport to any other member in your party.</p>
<p>For this example, we'll use the following command syntax:</p>
<pre><code class="language-mccmd">/party create &lt;partyName&gt;
/party tp &lt;player&gt;
</code></pre>
<p>To represent our party in code, we'll use a simple <code>Map</code> called <code>partyMembers</code> which maps the player's UUID to the name of their registered party:</p>
<div class="multi-pre">
<pre><code class="language-java Java">Map&lt;UUID, String&gt; partyMembers = new HashMap&lt;&gt;();
</code></pre>
<pre><code class="language-kotlin Kotlin">val partyMembers = mutableMapOf&lt;UUID, String&gt;()
</code></pre>
</div>
<p>To begin with, let's create the <code>/party create &lt;partyName&gt;</code> command. First, we must declare our arguments:</p>
<div class="multi-pre">
<pre><code class="language-java Java">List&lt;Argument&lt;?&gt;&gt; arguments = new ArrayList&lt;&gt;();

// The &quot;create&quot; literal, with a requirement that a player must have a party
arguments.add(new LiteralArgument(&quot;create&quot;)
    .withRequirement(sender -&gt; !partyMembers.containsKey(((Player) sender).getUniqueId()))
);

arguments.add(new StringArgument(&quot;partyName&quot;));
</code></pre>
<pre><code class="language-kotlin Kotlin">var arguments = mutableListOf&lt;Argument&lt;*&gt;&gt;()

// The &quot;create&quot; literal, with a requirement that a player must have a party
arguments.add(LiteralArgument(&quot;create&quot;)
    .withRequirement { !partyMembers.containsKey((it as Player).uniqueId) }
)

arguments.add(StringArgument(&quot;partyName&quot;))
</code></pre>
</div>
<p>In this argument declaration, we put a requirement on the literal <code>create</code>, where the player does not have a party. In other words, if the player does not have a party, they are allowed to run <code>/party create &lt;partyName&gt;</code>. If a player already has a party, then they won't be allowed to run this command.</p>
<p>Now that we've declared our arguments, we can now declare our main command <code>/party create &lt;partyName&gt;</code>. We populate it with the arguments, and we create an entry in our <code>partyMembers</code> with the player's UUID and the name of the party that they created. Since this updates the requirements of the player, we'll have to make sure we update it (which is covered in more detail in the section about updating requirements below) - until then, I'll omit this from the code:</p>
<div class="multi-pre">
<pre><code class="language-java Java">new CommandAPICommand(&quot;party&quot;)
    .withArguments(arguments)
    .executesPlayer((player, args) -&gt; {
        
        // Get the name of the party to create
        String partyName = (String) args.get(&quot;partyName&quot;);
        
        partyMembers.put(player.getUniqueId(), partyName);
    })
    .register();
</code></pre>
<pre><code class="language-kotlin Kotlin">CommandAPICommand(&quot;party&quot;)
    .withArguments(*arguments.toTypedArray())
    .executesPlayer(PlayerCommandExecutor { player, args -&gt;

        // Get the name of the party to create
        val partyName = args[&quot;partyName&quot;] as String

        partyMembers[player.uniqueId] = partyName
    })
    .register()
</code></pre>
</div>
<hr />
<p>So now we've added the ability to create a party if we're not already in it. Now we need to implement our <code>party tp &lt;player&gt;</code> command. Again, we must start by declaring our arguments:</p>
<div class="multi-pre">
<pre><code class="language-java Java">arguments = new ArrayList&lt;&gt;();
arguments.add(new LiteralArgument(&quot;tp&quot;)
    .withRequirement(sender -&gt; partyMembers.containsKey(((Player) sender).getUniqueId()))
);

arguments.add(new PlayerArgument(&quot;player&quot;)
    .replaceSafeSuggestions(SafeSuggestions.suggest(info -&gt; {
        
        // Store the list of party members to teleport to
        List&lt;Player&gt; playersToTeleportTo = new ArrayList&lt;&gt;();
        
        String partyName = partyMembers.get(((Player) info.sender()).getUniqueId());
        
        // Find the party members
        for (Entry&lt;UUID, String&gt; entry : partyMembers.entrySet()) {
            
            // Ignore yourself
            if (entry.getKey().equals(((Player) info.sender()).getUniqueId())) {
                continue;
            } else {
                // If the party member is in the same party as you
                if (entry.getValue().equals(partyName)) {
                    Player target = Bukkit.getPlayer(entry.getKey());
                    if (target.isOnline()) {
                        // Add them if they are online
                        playersToTeleportTo.add(target);
                    }
                }
            }
        }
        
        return playersToTeleportTo.toArray(new Player[0]);
    })));
</code></pre>
<pre><code class="language-kotlin Kotlin">arguments = mutableListOf&lt;Argument&lt;*&gt;&gt;()
arguments.add(LiteralArgument(&quot;tp&quot;)
    .withRequirement { partyMembers.containsKey((it as Player).uniqueId) })

arguments.add(PlayerArgument(&quot;player&quot;)
    .replaceSafeSuggestions(SafeSuggestions.suggest { info -&gt;

        // Store the list of party members to teleport to
        val playersToTeleportTo = mutableListOf&lt;Player&gt;()

        val partyName = partyMembers[(info.sender() as Player).uniqueId]

        // Find the party members
        for ((uuid, party) in partyMembers) {

            // Ignore yourself
            if (uuid == (info.sender() as Player).uniqueId) {
                continue
            } else {
                // If the party member is in the same party as you
                if (party == partyName) {
                    val target = Bukkit.getPlayer(uuid)!!
                    if (target.isOnline) {
                        // Add them if they are online
                        playersToTeleportTo.add(target)
                    }
                }
            }
        }

        playersToTeleportTo.toTypedArray()
    }))
</code></pre>
</div>
<p>Notice something here? There's some code repetition for the <code>withRequirement</code> method - this is the same predicate that we used earlier, except we remove the negation. If you are interested, you can view the section <a href="./predicatetips.html">Predicate tips</a> for a method to improve code reuse.</p>
<p>Once the arguments have been declared, we can now implement our party teleportation command:</p>
<div class="multi-pre">
<pre><code class="language-java Java">new CommandAPICommand(&quot;party&quot;)
    .withArguments(arguments)
    .executesPlayer((player, args) -&gt; {
        Player target = (Player) args.get(&quot;player&quot;);
        player.teleport(target);
    })
    .register();
</code></pre>
<pre><code class="language-kotlin Kotlin">CommandAPICommand(&quot;party&quot;)
    .withArguments(arguments)
    .executesPlayer(PlayerCommandExecutor { player, args -&gt;
        val target = args[&quot;player&quot;] as Player
        player.teleport(target)
    })
    .register()
</code></pre>
</div>
<hr />
<p>What's important to note in this example is that if you spend the time to set up the arguments properly, it severely decreases the amount of code required to write your command. This makes the commands you declare easier to understand and follow and you don't end up having to put all of these checks in the body of your command executor.</p>
</div>
<hr />
<h2 id="updating-requirements"><a class="header" href="#updating-requirements">Updating requirements</a></h2>
<p>Finally, the part you've all been waiting for - how to update requirements. With the way requirements work, they need to be updated manually. To illustrate why this is the case, I'll explain using <a href="./requirements.html#example---perks-based-on-a-players-level">the example of the /repair command</a>:</p>
<p>When a player joins the game, the server tells the client the list of all commands that the client can run <em>(don't worry, this is completely normal, as declared <a href="https://wiki.vg/Protocol#Declare_Commands">here</a>)</em>. Let's say that the player has joined and has less than 30 levels.</p>
<p>When a player has less than 30 levels, they are unable to execute the <code>/repair</code> command, because the list of commands that the server sent to the client did not contain the <code>/repair</code> command. Eventually, the player will fight some mobs or mine some ores and eventually will reach 30 levels. Despite this, the player's client doesn't actually know that they're now able to use the <code>/repair</code> command until the server tells them. As such, the server needs to somehow update the requirements that a player has so a player knows they can run the command.</p>
<p>The CommandAPI handles this in a very simple method call:</p>
<pre><code class="language-java">CommandAPI.updateRequirements(player);
</code></pre>
<div class="warning">
<p><strong>Developer's Note:</strong></p>
<p>The <code>CommandAPI.updateRequirements(player);</code> method can be used anywhere, <strong>except</strong> for the <code>withRequirement</code> method. Using it inside this method will crash the server. This is by design - just make sure you don't use it within the <code>withRequirement</code> method and everything will be fine!</p>
</div>
<p>To illustrate how to use this, we'll go over the two examples above:</p>
<div class="example">
<h3 id="example---updating-requirements-for-xp-changes"><a class="header" href="#example---updating-requirements-for-xp-changes">Example - Updating requirements for xp changes</a></h3>
<p>In <a href="./requirements.html#example---perks-based-on-a-players-level">the example of requirements with the /repair command</a>, we needed to ensure that the player's requirements update when their experience changes. To do this, we'll simply use a normal event to check this:</p>
<pre><code class="language-java">@EventHandler
public void onExpChange(PlayerExpChangeEvent event) {
    CommandAPI.updateRequirements(event.getPlayer());
}
</code></pre>
<p>And of course, you have to ensure that this event is registered in your <code>onEnable()</code> method:</p>
<pre><code class="language-java">@Override
public void onEnable() {
    getServer().getPluginManager().registerEvents(this, this);
}
</code></pre>
<blockquote>
<p><strong>Developer's Note:</strong></p>
<p>I'm assuming you already know how to register events and don't need me to go into great detail how to do so, take the code above with a pinch of salt - I know how much everyone likes to divide their event handlers and listeners to organise their code.</p>
</blockquote>
</div>
<div class="example">
<h3 id="example---updating-requirements-for-the-party-creation-example"><a class="header" href="#example---updating-requirements-for-the-party-creation-example">Example - Updating requirements for the party creation example</a></h3>
<p>In the <a href="./requirements.html#example---a-party-creation-and-teleportation-system">example for a party creation</a>, we declared two commands:</p>
<pre><code class="language-mccmd">/party create &lt;partyName&gt;
/party tp &lt;player&gt;
</code></pre>
<p>When a player creates a new party, we need to ensure that their requirements are updated <em>when they create the party</em>. As such, we simply add this to our party creation command executor:</p>
<div class="multi-pre">
<pre><code class="language-java Java">new CommandAPICommand(&quot;party&quot;)
    .withArguments(arguments)
    .executesPlayer((player, args) -&gt; {
        
        // Get the name of the party to create
        String partyName = (String) args.get(&quot;partyName&quot;);
        
        partyMembers.put(player.getUniqueId(), partyName);
        
        CommandAPI.updateRequirements(player);
    })
    .register();
</code></pre>
<pre><code class="language-kotlin Kotlin">CommandAPICommand(&quot;party&quot;)
    .withArguments(arguments)
    .executesPlayer(PlayerCommandExecutor { player, args -&gt;

        // Get the name of the party to create
        val partyName = args[&quot;partyName&quot;] as String

        partyMembers[player.uniqueId] = partyName

        CommandAPI.updateRequirements(player)
    })
    .register()
</code></pre>
</div>
<p>That's it!</p>
</div>
<hr />
<h2 id="multiple-requirements"><a class="header" href="#multiple-requirements">Multiple requirements</a></h2>
<p>The CommandAPI lets you handle multiple requirements really easily! The <code>withRequirement</code> method can be called multiple times, so you don't have to worry about shoving everything in one expression.</p>
<div class="example">
<h3 id="example---using-multiple-requirements"><a class="header" href="#example---using-multiple-requirements">Example - Using multiple requirements</a></h3>
<p>For example, you can apply multiple requirements for a command by calling the <code>withRequirement</code> method multiple times:</p>
<div class="multi-pre">
<pre><code class="language-java Java">new CommandAPICommand(&quot;someCommand&quot;)
    .withRequirement(sender -&gt; ((Player) sender).getLevel() &gt;= 30)
    .withRequirement(sender -&gt; ((Player) sender).getInventory().contains(Material.DIAMOND_PICKAXE))
    .withRequirement(sender -&gt; ((Player) sender).isInvulnerable())
    .executesPlayer((player, args) -&gt; {
        // Code goes here
    })
    .register();
</code></pre>
<pre><code class="language-kotlin Kotlin">CommandAPICommand(&quot;someCommand&quot;)
    .withRequirement { (it as Player).level &gt;= 30 }
    .withRequirement { (it as Player).inventory.contains(Material.DIAMOND_PICKAXE) }
    .withRequirement { (it as Player).isInvulnerable() }
    .executesPlayer(PlayerCommandExecutor { player, args -&gt;
        // Code goes here
    })
    .register()
</code></pre>
</div>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="permissions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fas fa-chevron-left"></i>
                            </a>

                            <a rel="next" href="aliases.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fas fa-chevron-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="permissions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fas fa-chevron-left"></i>
                    </a>

                    <a rel="next" href="aliases.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fas fa-chevron-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="sidebar.js"></script>
        <script type="text/javascript" src="mccmd.js"></script>
        <script type="text/javascript" src="kotlin-dsl.js"></script>
        <script type="text/javascript" src="jszip.min.js"></script>
        <script type="text/javascript" src="yaml.min.js"></script>
        <script type="text/javascript" src="pluginyml.js"></script>


    </body>
</html>
